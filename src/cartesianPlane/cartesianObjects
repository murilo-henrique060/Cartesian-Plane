import pygame

class Circle:
    def __init__(self, plane, color: tuple | list, center : list, radius : int | float, width : int = 0):
        """Create a Circle Object on the Cartesian Plane

        Args:
            plane (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the circle
            center (list): The position of the center of the circle
            radius (int | float): The radius of the circle
            width (int, optional): Width of the border of the circle. 0 to fill the object. Defaults to 0.
        """
        self.plane = plane
        self.center = center
        self.radius = radius
        self.color = color
        self.width = width

        self.plane.objects.append(self)

    def draw(self):
        """Draw the circle
        """
        # Convert Cartesian to Screen Coordinates
        center = self.plane.plane_to_screen(self.center)
        radius = self.plane.scale(self.radius)

        if self.plane.is_in_screen([self.center[0] - self.radius, self.center[1], self.radius], self.radius * 2, self.radius * 2):
            # Draw the circle
            pygame.draw.circle(self.plane.screen, self.color, center, radius, self.width)

class Rect:
    def __init__(self, plane, color : tuple | list, rect : list, width : int = 0):
        """Create a Rectangle Object on the Cartesian Plane

        Args:
            plane (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the rectangle
            rect (list): The rectangle dimentions. [x, y, width, height]
            width (int, optional): Width of the border of the rectangle. 0 to fill the object. Defaults to 0.
        """
        self.plane = plane
        self.rect = [rect[0], rect[1]]
        self.width = rect[2]
        self.height = rect[3]
        self.color = color
        self.line_width = width

        self.plane.objects.append(self)

    def draw(self):
        """Draw the rectangle
        """
        # Convert Cartesian to Screen Coordinates
        rect = self.plane.plane_to_screen(self.rect)
        width = self.plane.scale(self.width)
        height = self.plane.scale(self.height)

        if self.plane.is_in_screen(self.rect, self.width, self.height):
            # Draw the rectangle
            pygame.draw.rect(self.plane.screen, self.color, [*rect, width, height], self.line_width)

class Line:
    def __init__(self, plane, color : tuple | list, start : list, end : list, width : int = 1):
        """Create a Line Object on the Cartesian Plane

        Args:
            plane (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the line
            start (list): The start position of the line
            end (list): The end position of the line
            width (int, optional): Width of the line. Defaults to 1.
        """
        self.plane = plane
        self.start = start
        self.end = end
        self.color = color
        self.width = width

        self.plane.objects.append(self)

    def draw(self):
        """Draw the line
        """
        # Convert Cartesian to Screen Coordinates
        start = self.plane.plane_to_screen(self.start)
        end = self.plane.plane_to_screen(self.end)

        if self.plane.is_in_screen(self.start, self.end[0] - self.start[0], self.end[1] - self.start[1]):
            # Draw the line
            pygame.draw.line(self.plane.screen, self.color, start, end, self.width)

class Path:
    def __init__(self, plane, color : tuple | list, *points : tuple | list, length : int= 100):
        """Create a Path Object on the Cartesian Plane

        Args:
            plane (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the path
            length (int, optional): Numbers of points. Defaults to 100.
        """
        self.plane = plane
        self.color = color
        self.path = [*points]
        self.length = length

        self.plane.objects.append(self)

    def add_point(self, point : list):
        """Add a point to the path

        Args:
            point (list): The point to add
        """
        if len(self.path) > self.length and self.length >= 0:
            self.path.pop(0)

        self.path.append(point)

    def draw(self):
        """Draw the path
        """
        # Convert Cartesian to Screen Coordinates
        path = [self.plane.plane_to_screen(point) for point in self.path]

        # Draw the path
        for point in path:
            self.plane.screen.set_at(point, self.color)

class draw:
    def circle(surface, color : tuple | list, center : list, radius : int | float, width : int = 0):
        """Draw a circle on the Cartesian Plane

        Args:
            surface (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the circle
            center (list): The position of the center of the circle
            radius (int | float): The radius of the circle
            width (int, optional): Width of the border of the circle. 0 to fill. Defaults to 0.
        """
        pygame.draw.circle(surface.screen, color, surface.plane_to_screen(center), surface.scale(radius), width=width)

    def rect(surface, color : tuple | list, rect : list, width : int = 0):
        """Draw a rectangle on the Cartesian Plane

        Args:
            surface (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the rectangle
            rect (list): The rectangle dimentions. [x, y, width, height]
            width (int, optional): Width of the border of the rectangle. 0 to fill. Defaults to 0.
        """
        pygame.draw.rect(surface.screen, color, [*surface.plane_to_screen((rect[0], rect[1])), surface.scale(rect[2]), surface.scale(rect[3])], width=width)

    def line(surface, color : tuple | list, start_pos : list, end_pos : list, width : int = 1):
        """Draw a line on the Cartesian Plane

        Args:
            surface (Cartesian Plane): The Cartesian Plane
            color (tuple | list): The color of the line
            start_pos (list): The start position of the line
            end_pos (list): The end position of the line
            width (int, optional): Width of the line. Defaults to 1.
        """
        pygame.draw.line(surface.screen, color, surface.plane_to_screen(start_pos), surface.plane_to_screen(end_pos), width=surface.scale(width))